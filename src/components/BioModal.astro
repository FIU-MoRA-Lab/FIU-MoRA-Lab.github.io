---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";

interface Props {
    person: CollectionEntry<"team">["data"];
    id: string;
}

const { person, id } = Astro.props;
---

<dialog
    id={id}
    class="bg-transparent p-0 w-full h-full max-w-none max-h-none backdrop:backdrop-blur-sm backdrop:bg-black/20 dark:backdrop:bg-black/60 m-0"
    onclick="if(event.target === this) this.close()"
>
    <!-- Modal Card Container -->
    <div
        class="bg-white dark:bg-[#1a1a1a] w-[90vw] max-w-2xl overflow-hidden flex flex-col max-h-[85vh] relative border border-gray-200 dark:border-[#333]"
    >
        <!-- Close Button (Absolute) -->
        <form method="dialog" class="absolute top-4 right-4 z-20">
            <button
                class="bg-white/80 dark:bg-black/50 hover:bg-white dark:hover:bg-black w-8 h-8 flex items-center justify-center rounded-full text-black dark:text-white transition-colors backdrop-blur-md"
                aria-label="Close modal"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                >
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </form>

        <!-- Content Section -->
        <div class="p-8 md:p-12 overflow-y-auto flex flex-col h-full relative">
            <!-- Header (Image + Name/Title) -->
            <div class="flex items-center gap-6 mb-8 pt-2">
                <!-- Image -->
                <div class="w-20 h-20 md:w-24 md:h-24 shrink-0 overflow-hidden">
                    <Image
                        src={person.image}
                        alt={person.name}
                        class="w-full h-full object-cover"
                    />
                </div>

                <!-- Name/Title -->
                <div>
                    <h3
                        class="text-2xl md:text-3xl font-medium text-black dark:text-white mb-1 leading-tight"
                    >
                        {person.name}
                    </h3>
                    {
                        person.title && (
                            <p class="text-xs md:text-sm text-gray-500 dark:text-gray-400 uppercase tracking-widest font-medium">
                                {person.title}
                            </p>
                        )
                    }
                </div>
            </div>

            <!-- Bio -->
            <div
                class="prose dark:prose-invert prose-sm max-w-none text-gray-700 dark:text-gray-300 leading-relaxed mb-8 flex-grow text-xs"
            >
                <p>{person.bio}</p>
            </div>

            <!-- Links -->
            {
                person.links.length > 0 && (
                    <div class="pt-8 border-t border-gray-100 dark:border-[#333] flex flex-wrap gap-4 mt-auto">
                        {person.links.map(
                            (link: { label: string; url: string }) => (
                                <a
                                    href={link.url}
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    class="text-gray-600 dark:text-gray-400 hover:text-black dark:hover:text-white underline decoration-1 underline-offset-4 transition-colors text-[10px] tracking-wider"
                                >
                                    [{link.label}]
                                </a>
                            ),
                        )}
                    </div>
                )
            }
        </div>
    </div>
</dialog>

<style>
    dialog {
        /* Reset default dialog positioning to allow flex centering from parent */
        inset: 0;
        position: fixed;
        /* Animation */
        animation: fade-out 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }

    dialog[open] {
        display: flex; /* Override browser default 'block' */
        align-items: center;
        justify-content: center;
        animation: fade-in 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }

    dialog::backdrop {
        background: rgba(
            0,
            0,
            0,
            0
        ); /* Managed via tailwind classes on dialog for blur support */
    }

    dialog[open]::backdrop {
        animation: backdrop-fade-in 0.3s ease-out forwards;
    }

    @keyframes fade-in {
        0% {
            opacity: 0;
            transform: scale(0.98);
        }
        100% {
            opacity: 1;
            transform: scale(1);
        }
    }

    @keyframes fade-out {
        0% {
            opacity: 1;
            transform: scale(1);
        }
        100% {
            opacity: 0;
            transform: scale(0.98);
            display: none;
        }
    }

    @keyframes backdrop-fade-in {
        0% {
            opacity: 0;
        }
        100% {
            opacity: 1;
        }
    }
</style>
