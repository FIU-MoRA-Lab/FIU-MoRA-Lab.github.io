---

---

<button
    id="theme-toggle"
    aria-label="Toggle Dark Mode"
    class="theme-toggle w-7 h-7 rounded-full flex items-center justify-center transition-all duration-300 bg-gray-800 hover:bg-gray-900 dark:bg-gray-300 dark:hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-neutral-700"
    title="Toggle Theme"
>
    <!-- 
      Icon Container: Fixed size.
      We use two halves. 
    -->
    <div class="relative w-4 h-4 flex">
        <!-- Left Half: Disappears in Light Mode -->
        <div
            class="w-2 h-4 bg-[var(--color-bg-primary)] dark:bg-gray-100 rounded-l-full transition-all duration-300 ease-out origin-right"
            id="moon-left"
        >
        </div>
        <!-- Right Half: Always Visible -->
        <div
            class="w-2 h-4 bg-[var(--color-bg-primary)] dark:bg-gray-100 rounded-r-full transition-colors duration-300"
        >
        </div>
    </div>
</button>

<style>
    /* 
       Light Mode: Left half scales to 0 width.
       Transform layout does not affect flow, so Right half stays in place.
    */
    :global(html:not(.dark)) #moon-left {
        transform: scaleX(0);
        opacity: 0;
    }

    :global(html.dark) #moon-left {
        transform: scaleX(1);
        opacity: 1;
    }
</style>

<script>
    document.addEventListener("astro:page-load", () => {
        const toggle = document.getElementById("theme-toggle");

        const handleToggleClick = () => {
            const element = document.documentElement;
            element.classList.toggle("dark");
            const isDark = element.classList.contains("dark");
            localStorage.setItem("theme", isDark ? "dark" : "light");
        };

        toggle?.addEventListener("click", handleToggleClick);
    });
</script>
