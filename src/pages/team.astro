---
import Layout from "../layouts/Layout.astro";
import PersonCard from "../components/PersonCard.astro";
import PageHeader from "../components/PageHeader.astro";
import { getCollection, type CollectionEntry } from "astro:content";

const teamMembers = (await getCollection("team")).sort(
    (a: TeamEntry, b: TeamEntry) => a.data.name.localeCompare(b.data.name),
);

const sections = [
    { title: "Faculty", key: "faculty" },
    { title: "Graduate Students", key: "graduate" },
    { title: "Undergraduate Students", key: "undergraduate" },
    { title: "Collaborators", key: "collaborators" },
    { title: "Alumni", key: "alumni" },
] as const;

type TeamEntry = CollectionEntry<"team">;
---

<Layout>
    <div class="min-h-screen">
        <div
            class="container mx-auto px-4 pt-4 pb-8 md:pt-8 md:pb-16 max-w-4xl"
        >
            <!-- Header -->
            <PageHeader title="Team" />

            {
                sections.map(({ title, key }) => {
                    const people = teamMembers.filter(
                        (m: TeamEntry) => m.data.role === key,
                    );
                    if (!people || people.length === 0) return null;

                    return (
                        <section class="mb-10 md:mb-16">
                            <h2 class="text-xl md:text-2xl font-bold tracking-widest mb-6 md:mb-8 text-black dark:text-white">
                                {title}
                            </h2>
                            <div class="grid responsive-grid">
                                {people.map((person: TeamEntry) => (
                                    <PersonCard person={person.data} />
                                ))}
                            </div>
                        </section>
                    );
                })
            }
        </div>
    </div>
</Layout>

<style>
    .responsive-grid {
        grid-template-columns: 1fr;
    }
    @media (min-width: 768px) {
        .responsive-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }
    @media (min-width: 1024px) {
        .responsive-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }
</style>
